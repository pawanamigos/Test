<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="509px" preserveAspectRatio="none" style="width:797px;height:509px;background:#FFFFFF;" version="1.1" viewBox="0 0 797 509" width="797px" zoomAndPan="magnify"><defs><filter height="300%" id="funuo2pzyb94u" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="64" x2="64" y1="83.5938" y2="425.3203"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="318.5" x2="318.5" y1="83.5938" y2="425.3203"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="472" x2="472" y1="83.5938" y2="425.3203"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="660" x2="660" y1="83.5938" y2="425.3203"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="750" x2="750" y1="83.5938" y2="425.3203"/><rect fill="#FEFECE" filter="url(#funuo2pzyb94u)" height="62.8906" style="stroke:#A80036;stroke-width:1.5;" width="114" x="5" y="15.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="41" y="35.6982">Image</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="12" y="51.9951">Categorization</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="42.5" y="68.292">Client</text><rect fill="#FEFECE" filter="url(#funuo2pzyb94u)" height="62.8906" style="stroke:#A80036;stroke-width:1.5;" width="114" x="5" y="424.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="41" y="444.3154">Image</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="12" y="460.6123">Categorization</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="42.5" y="476.9092">Client</text><rect fill="#FEFECE" filter="url(#funuo2pzyb94u)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="119" x="257.5" y="32"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="264.5" y="51.9951">Upload Handler</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="287" y="68.292">(lambda)</text><rect fill="#FEFECE" filter="url(#funuo2pzyb94u)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="119" x="257.5" y="424.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="105" x="264.5" y="444.3154">Upload Handler</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="287" y="460.6123">(lambda)</text><rect fill="#FEFECE" filter="url(#funuo2pzyb94u)" height="62.8906" style="stroke:#A80036;stroke-width:1.5;" width="74" x="433" y="15.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="17" x="461.5" y="35.6982">s3</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="452" y="51.9951">Hook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="440" y="68.292">(lambda)</text><rect fill="#FEFECE" filter="url(#funuo2pzyb94u)" height="62.8906" style="stroke:#A80036;stroke-width:1.5;" width="74" x="433" y="424.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="17" x="461.5" y="444.3154">s3</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="452" y="460.6123">Hook</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="440" y="476.9092">(lambda)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="626" y="63.9951">Postgres</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="637" y="80.292">(RDS)</text><path d="M642,15 C642,5 660,5 660,5 C660,5 678,5 678,15 L678,41 C678,51 660,51 660,51 C660,51 642,51 642,41 L642,15 " fill="#FEFECE" filter="url(#funuo2pzyb94u)" style="stroke:#000000;stroke-width:1.5;"/><path d="M642,15 C642,25 660,25 660,25 C660,25 678,25 678,15 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="626" y="437.3154">Postgres</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="637" y="453.6123">(RDS)</text><path d="M642,466.9141 C642,456.9141 660,456.9141 660,456.9141 C660,456.9141 678,456.9141 678,466.9141 L678,492.9141 C678,502.9141 660,502.9141 660,502.9141 C660,502.9141 642,502.9141 642,492.9141 L642,466.9141 " fill="#FEFECE" filter="url(#funuo2pzyb94u)" style="stroke:#000000;stroke-width:1.5;"/><path d="M642,466.9141 C642,476.9141 660,476.9141 660,476.9141 C660,476.9141 678,476.9141 678,466.9141 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="704" y="63.9951">Object Store</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="733.5" y="80.292">(s3)</text><path d="M732,15 C732,5 750,5 750,5 C750,5 768,5 768,15 L768,41 C768,51 750,51 750,51 C750,51 732,51 732,41 L732,15 " fill="#FEFECE" filter="url(#funuo2pzyb94u)" style="stroke:#000000;stroke-width:1.5;"/><path d="M732,15 C732,25 750,25 750,25 C750,25 768,25 768,15 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="704" y="437.3154">Object Store</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="27" x="733.5" y="453.6123">(s3)</text><path d="M732,466.9141 C732,456.9141 750,456.9141 750,456.9141 C750,456.9141 768,456.9141 768,466.9141 L768,492.9141 C768,502.9141 750,502.9141 750,502.9141 C750,502.9141 732,502.9141 732,492.9141 L732,466.9141 " fill="#FEFECE" filter="url(#funuo2pzyb94u)" style="stroke:#000000;stroke-width:1.5;"/><path d="M732,466.9141 C732,476.9141 750,476.9141 750,476.9141 C750,476.9141 768,476.9141 768,466.9141 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><polygon fill="#A80036" points="307,110.7266,317,114.7266,307,118.7266,311,114.7266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="64" x2="313" y1="114.7266" y2="114.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231" x="71" y="109.6606">Metadata including name, size, tags</text><polygon fill="#A80036" points="648,154.9922,658,158.9922,648,162.9922,652,158.9922" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="319" x2="654" y1="158.9922" y2="158.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="326" y="138.7935">Creates record for</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="326" y="153.9263">image and tags</text><line style="stroke:#A80036;stroke-width:1.0;" x1="319" x2="361" y1="203.2578" y2="203.2578"/><line style="stroke:#A80036;stroke-width:1.0;" x1="361" x2="361" y1="203.2578" y2="216.2578"/><line style="stroke:#A80036;stroke-width:1.0;" x1="320" x2="361" y1="216.2578" y2="216.2578"/><polygon fill="#A80036" points="330,212.2578,320,216.2578,330,220.2578,326,216.2578" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="326" y="183.0591">Generates pre-signed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="326" y="198.1919">upload url</text><polygon fill="#A80036" points="75,241.3906,65,245.3906,75,249.3906,71,245.3906" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="69" x2="318" y1="245.3906" y2="245.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="81" y="240.3247">Returns ID + upload_url</text><polygon fill="#A80036" points="738,270.5234,748,274.5234,738,278.5234,742,274.5234" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="64" x2="744" y1="274.5234" y2="274.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="71" y="269.4575">PUTs image to upload_url</text><polygon fill="#A80036" points="483,299.6563,473,303.6563,483,307.6563,479,303.6563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="477" x2="749" y1="303.6563" y2="303.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153" x="489" y="298.5903">notifies image uploaded</text><polygon fill="#A80036" points="738,359.0547,748,363.0547,738,367.0547,742,363.0547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="472" x2="744" y1="363.0547" y2="363.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="479" y="327.7231">inspects upload</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="479" y="342.856">moves to permanent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="479" y="357.9888">location</text><polygon fill="#A80036" points="648,403.3203,658,407.3203,648,411.3203,652,407.3203" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="472" x2="654" y1="407.3203" y2="407.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="479" y="387.1216">marks image upload time</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="479" y="402.2544">and permanent key</text><!--MD5=[5f788420c34f962cb9573bca268b04f7]
@startuml

participant "Image\nCategorization\nClient" as client
participant "Upload Handler\n(lambda)" as post_handler
participant "s3\nHook\n(lambda)" as s3_hook
database "Postgres\n(RDS)" as db
database "Object Store\n(s3)" as s3

client -> post_handler: Metadata including name, size, tags
post_handler -> db: Creates record for\nimage and tags
post_handler -> post_handler: Generates pre-signed\nupload url
post_handler -> client: Returns ID + upload_url
client -> s3: PUTs image to upload_url
s3 -> s3_hook: notifies image uploaded
s3_hook -> s3: inspects upload\nmoves to permanent\nlocation
s3_hook -> db: marks image upload time\nand permanent key


@enduml

PlantUML version 1.2021.16(Wed Dec 08 17:25:22 UTC 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>